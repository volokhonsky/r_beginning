---
title: "АНАЛИЗ ДАННЫХ В СОЦИАЛЬНЫХ НАУКАХ С ПОМОЩЬЮ ЯЗЫКА R"
output: 
  ioslides_presentation:
    self_contained: yes
    incremental: true
    widescreen: true
---

# День шестой. функции и циклы

## Первый слайд


Итак, что же такое функции

```{r eval=F}

имя_функции <- function (аргументы, которые функция принимает)

{
тело функции
  return (что функция возвращает)
}

```

```{r include=FALSE}
load("data/iGLAS.Rdata")
library(data.table)
```

##
минимальный пример:

```{r}
new.function <- function(a) {
  
  result<-(1:a)/2
  return(result)
}	
new.function(a=10)
```

##
Но вообще-то у функции может и не быть аргументов, а return оформлять не обязательно, туда автоматически идёт первый результат. И если в функции одна строка, то и фигурные скобки не нужны

```{r}
fool<-function() "Ты что, дурачок, делать функции без аргументов?"
fool()

```


##
у функции могут быть значения аргументов по умолчанию

```{r}
new.function <- function(a=5) {
  
  result<-(1:a)/2
  return(result)
}	
new.function()
```

##

А теперь попробуйте написать функцию, которая вычисляет длину гипотенузы при получении на вход длины двух катетов. 


##

Аргументы функции желательно проверять. 
Чему будет равна гипотенуза, если длина одного обоих катетов равна -2? 

Нужны информативные сообщения об ошибках и нам поможет команда stop с условиями. 

```{r}

f<-function (a)
{
if (a %% 2 != 0) 
    {
      stop("число нечётное")
    }
 a/2
}

 f(a=444)
 f(a=33)
```

Поправьте свою функцию гипотенузы. 


##
У аргументов есть порядок. При вызове функции можно перечислять их по порядку. Вызванные по имени аргументы исключаются из порядка. 
```{r}
f<-function(a,b,c)
{
(a-b)*c  
}
f(2,3,5)
f(c=2,3,5)

```

## lazy evaluation

функция выполняется последовательно. Если какого-то аргумента нет, это будет ясно только в тот момент, когда он понадобится. 
```{r}
f<-function(a,b)
{
print(a)
print(b)
}

f(a=5)

```

## пространство имён

```{r}


```

## разберёмся с lapply

```{r}

```

## 
lapply(.SD) в data.table
```{r}

```

## sapply


## apply



##
Задание для самостоятельной работы

1) Написать функцию, которая принимает на вход числовой вектор, вычисляет 25 и 75 процентиль и делит по ним этот вектор, возвращая 25% "lo", 50% " middle", 25% "hi". 
Назовите функцию "to_three_levels". 
to_three_levels(1:8) должно возвращать вектор c("lo","lo","middle","middle","middle","middle", "hi","hi")

2) написать функцию, которая отвечает на вопрос, является ли вектор полностью состоящим из пропусков

3) применить эту функцию ко всем столбцам нашего датасета

продолжение на следующей странице

##


4) создать новую таблицу, в которой не будет всех этих столбиков

5) написать функцию, которая принимает на вход вектор, содержащий одну категориальную переменную и возвращает построенный по ней тот график, который вам хочется. Например, столбики с частотой. 

6) Составить список из 10 категориальных переменных нашего датасета и с помощью цикла и предыдущей функции записать на диск графики с результатами. 






